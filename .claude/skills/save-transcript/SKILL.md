---
name: save-transcript
description: Saves the current conversation to Notion. Use when the user asks to save, export, or record the conversation transcript.
---

# Save Transcript Skill

Save the current conversation to Notion.

## Usage

```
/save-transcript
```

## Instructions

When the user invokes this skill, follow these steps:

### 1. Auto-Generate Title

Create a concise, descriptive title (5-10 words) based on:
- The main task or goal of the conversation
- Key technologies or components involved
- Example: "Fix authentication bug in user service" or "Add dark mode toggle to settings"

### 2. Read Database ID and Schema

1. Read the database ID from the `.env` file (`NOTION_TRANSCRIPT_DATABASE_ID`)
2. If the env var is not set, ask the user: "Please provide the URL to your Transcripts database in Notion"
3. Fetch the database schema to discover:
   - Available tag options from the Tags multi_select property
   - Any other properties that need to be populated
4. If fetching the database fails, ask the user: "Unable to access the database. Please ensure it is shared with the Notion integration (click Share → Connections → add the integration)"

### 3. Auto-Detect Tags

Analyze the conversation and assign 1-3 relevant tags from the options available in the database schema. Match the conversation content to the most appropriate tags based on their names.

### 4. Generate Summary

Create a brief summary (3-5 bullet points) of this conversation covering:
- Main topic/goal
- Key decisions made
- Important code changes or files modified
- Outcome/result

### 5. Format the Transcript

Convert the current conversation to Notion-flavored markdown:
- Start with the generated summary in a callout block
- Add a horizontal rule
- Format each message as a callout (no icon) with a bold speaker label:
  - User messages: `<callout color="blue_bg">**User**<br><br>Message content</callout>`
  - Assistant messages: `<callout color="purple_bg">**Assistant**<br><br>Message content</callout>`
- Each callout should contain the full message content with proper formatting

#### Code Block Formatting

Code blocks inside callouts must be indented as children of the callout. Use triple backticks with the language identifier:

```
<callout color="purple_bg">
**Assistant**

Here's an example:
	```typescript
	function hello() {
	  console.log("Hello");
	}
	```
</callout>
```

- Always include the language hint (e.g., `typescript`, `python`, `bash`, `json`, `yaml`, `markdown`)
- Use `text` or omit the language for plain text/output
- Code blocks must be on their own lines, indented with a tab inside the callout
- Preserve the original indentation within the code itself

### 6. Save to Notion

Create a new page in the database found in step 2:

```
notion.createPage({
  database_id: "<from step 2>",
  properties: {
    Title: { title: [{ text: { content: "<auto-generated title>" } }] },
    Model: { select: { name: "<detected model>" } },
    Tool: { select: { name: "Claude Code" } },
    Tags: { multi_select: [{ name: "<auto-detected tags>" }] }
  },
  children: [
    // Notion blocks for the formatted content
  ]
})
```

### 7. Confirm Success

Report to the user:
- The page title
- A link to the created Notion page (if available)
- The tags applied

## Model Detection

Detect the current model from the conversation context or system info:
- Claude Opus 4.5, Claude Sonnet 4, etc.
- Default to "Claude Opus 4.5" if unknown
