---
name: save-transcript
description: Saves the current conversation transcript to Notion (creates a page in the transcript database).
---

# Save Transcript

Save the current conversation transcript to Notion.

## Prerequisites
- The user has a Notion database with the following properties:
  - Title: Title
  - Model: Select
  - Tool: Select
  - Tags: Multi-select
- The user has a Notion MCP server running and configured properly with access to the database.

## Instructions

When the user invokes this skill, follow these steps:

### 1. Auto-Generate Title

Create a concise, descriptive title (5-10 words) based on:
- The main task or goal of the conversation
- Key technologies or components involved
- Example: "Fix authentication bug in user service" or "Add dark mode toggle to settings"

### 2. Read Database ID and Schema

1. Read the database ID from the `.env` file (`NOTION_TRANSCRIPT_DATABASE_ID`)
2. If the env var is not set, ask the user: "Please provide the URL to your Transcripts database in Notion" to save to the env file. It should be a dashless UUID
3. Fetch the database schema to discover:
   - Available tag options from the Tags multi_select property
   - Available model options from the Model select property (e.g. "claude-opus-4.5", "claude-sonnet-4", etc)
   - Available tool options from the Tool select property (e.g. "Claude Code", "Cursor", "Codex CLI", etc)
4. If fetching the database fails, inform the user: "Unable to access the database. Please ensure database is properly configured in Notion and the MCP server is running."

### 3. Auto-Detect Tags

Analyze the conversation and assign relevant tags from the options that are available in the database schema. Match the conversation content to the most appropriate tags based on their names. 

### 4. Generate Summary

Create a brief summary (3-5 bullet points) of this conversation covering:
- Main topic/goal
- Key decisions made
- Important code changes or files modified
- Outcome/result

### 5. Format the Transcript

Convert the current conversation to Notion-flavored markdown:
- Start with the generated summary in a callout block
  - <callout color="gray_bg">**Summary**<br><br>Summary bullet points </callout>
- Add a horizontal rule
- Format each message as a callout (no icon) with a bold speaker label:
  - User messages: `<callout color="blue_bg">**User**<br><br>Message content</callout>`
  - Assistant messages: `<callout>**Assistant**<br><br>Message content</callout>`
- Each callout should contain the full message content with proper formatting
- Exclude the /save-transcript message and response from the transcript

#### Code Block Formatting

Code blocks inside callouts must be indented as children of the callout. Use triple backticks with the language identifier:

```
<callout>
**Assistant**

Here's an example:
	```typescript
	function hello() {
	  console.log("Hello");
	}
	```
</callout>
```

- Always include the language hint (e.g., `typescript`, `python`, `bash`, `json`, `yaml`, `markdown`)
- Use `text` or omit the language for plain text/output
- Code blocks must be on their own lines, indented with a tab inside the callout
- Preserve the original indentation within the code itself

#### Tool Call Formatting

Tool calls and results are an important part of the conversation record. Format them as nested callouts within the Assistant message:

- **Tool calls:** Use `green_bg` callout with the tool name in bold
- **Tool results:** Summarize the result briefly (don't include full file contents or lengthy outputs)

Example:

```
<callout>
**Assistant**

Let me check the git status and read that file.

	<callout color="green_bg">
	**Tool: Bash** `git status`

	Output: On branch main, 2 files modified
	</callout>

	<callout color="green_bg">
	**Tool: Read** `src/config.ts`

	Read 45 lines from config file containing database settings.
	</callout>

Based on the status, I can see there are uncommitted changes...
</callout>
```

**Guidelines for tool results:**

- Summarize file reads (e.g., "Read 120 lines of React component handling user auth")
- Include key output from bash commands, truncate if very long
- For search results, mention what was found (e.g., "Found 5 matches in src/utils/")
- Skip redundant tool calls (e.g., multiple similar grep searches can be combined)

### 6. Save to Notion

Create a new page in the database found in step 2:

```
notion.createPage({
  database_id: "<from step 2>",
  properties: {
    Title: { title: [{ text: { content: "<auto-generated title>" } }] },
    Model: { select: { name: "<detected model>" } },
    Tool: { select: { name: "Codex CLI" } },
    Tags: { multi_select: [{ name: "<auto-detected tags>" }] }
  },
  children: [
    // Notion blocks for the formatted content
  ]
})
```

**Important:** Only set the properties listed above (Title, Model, Tool, Tags). Do not fill in other properties like Commentaryâ€”leave those for the user to complete manually.

### 7. Confirm Success

Report to the user:
- The page title
- A link to the created Notion page (if available)
- The tags applied

## Model Detection

Detect the current model from the conversation context or system info:
- gpt-4.1, o3, o4-mini, etc.
- Default to "unknown" if the model cannot be determined
- Add the model name to the database if it is not present
